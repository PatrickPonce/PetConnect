@using X.PagedList.Mvc.Core;
@using X.PagedList;
@model IPagedList<PetConnect.Models.Servicio>
@{
    ViewData["Title"] = "Directorio de Veterinarias";
}

<div class="directorio-container">
    <h1 class="directorio-title">Encuentra la mejor veterinaria para tu mascota</h1>
    
    <form asp-controller="Servicio" asp-action="Index" method="get">
        @* Llamamos a la vista parcial del buscador *@
        @await Html.PartialAsync("_SearchBarPartial", ViewData["BusquedaActual"] as string)
    </form>


    <div class="servicios-listado">
        @foreach (var servicio in Model)
        {
            <a asp-action="Detalle" asp-route-id="@servicio.Id" class="servicio-card-link">
                <div class="servicio-card">
                    <div class="card-image-container">
                        <img src="@(servicio.ImagenPrincipalUrl ?? "/images/placeholder.png")" alt="Imagen de @servicio.Nombre">
                    </div>
                    <div class="card-info">
                        <span class="servicio-categoria">@servicio.FundacionNombre</span>
                        <h5 class="servicio-nombre">@servicio.Nombre</h5>
                        @* Mostramos la direcci√≥n desde la tabla de detalles (aunque no la cargamos en esta vista por eficiencia) *@
                    </div>
                    <div class="card-actions">
                        <span class="btn-directorio">Ver Detalles</span>
                    </div>
                </div>
            </a>
        }
        <div class="pagination-container">
            @Html.PagedListPager(Model, page => Url.Action("Index", new { page, busqueda = ViewData["BusquedaActual"] }),
                new PagedListRenderOptions
                {
                    LiElementClasses = new string[] { "page-item" },
                    PageClasses = new string[] { "page-link" },
                    DisplayLinkToFirstPage = PagedListDisplayMode.Always,
                    DisplayLinkToLastPage = PagedListDisplayMode.Always,
                    DisplayLinkToNextPage = PagedListDisplayMode.Always,
                    DisplayLinkToPreviousPage = PagedListDisplayMode.Always
                })
        </div>
    </div>
</div>