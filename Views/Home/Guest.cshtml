@model List<PetConnect.Models.Noticia>
@using PetConnect.Services
@inject ConfiguracionSitioService configService

@{
    ViewData["Title"] = "Página de Invitado";

    var logoUrl = await configService.ObtenerValorAsync("UrlLogo", "/images/logoP.png");
    var logoVersion = await configService.ObtenerValorAsync("UrlLogoVersion", "1");
    var logoUrlConVersion = $"{logoUrl}?v={logoVersion}";

    var urlBanner = await configService.ObtenerValorAsync("UrlBanner", "/images/veterinaria_banner.jpg");
    var bannerVersion = await configService.ObtenerValorAsync("UrlBannerVersion", "1");
    var bannerUrlConVersion = $"{urlBanner}?v={bannerVersion}";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">

<style>
    /* --- ESTILOS GENERALES --- */
    body {
        background-color: #f7f3e8;
        font-family: 'Poppins', sans-serif;
    }
    .section-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 4rem 1rem;
    }
    .text-highlight { color: #E88989; /* Amarillo */ }
    .text-primary-custom { color: #E88989; /* Rosa */ }
    
    /* --- 1. HERO SECTION --- */
    .hero-section {
        position: relative;
        min-height: 480px; /* Un poco más alto para impactar */
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        color: white;
        padding: 2rem;
        margin-bottom: 4rem;
        /* Bordes redondeados solo abajo para un look moderno */
        border-radius: 0 0 50px 50px;
        overflow: hidden;
        /* Imagen de fondo dinámica (se define en el HTML) + fallback de color */
        background-color: #97a992; /* Color de respaldo si la imagen falla */
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat; /* Importante para que no se repita */
    }
    .hero-content {
        position: relative;
        z-index: 2;
        max-width: 800px;
        margin: 0 auto;
    }
    .hero-title {
        font-family: 'Fredoka', sans-serif;
        font-size: 3.5rem;
        margin-bottom: 1.5rem;
        line-height: 1.2;
    }
    .hero-subtitle {
        font-size: 1.4rem;
        opacity: 0.9;
        margin-bottom: 2.5rem;
    }
    .hero-btn {
        background-color: #E88989; /* Amarillo vibrante */
        color: #333;
        font-weight: 800;
        padding: 15px 40px;
        border-radius: 50px;
        text-decoration: none;
        font-size: 1.2rem;
        display: inline-block;
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        transition: transform 0.3s, box-shadow 0.3s;
    }
    .hero-btn:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        color: #333;
    }

    /* --- 2. SECCIÓN "LO QUE TENEMOS PARA TI" (Tarjetas coloridas) --- */
    .features-title {
        text-align: center;
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 3rem;
        color: #333;
        padding-top: 2rem; /* <-- AÑADIDO: Espacio extra arriba del título */
    }
    .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        /* margin-top: -5rem;  <-- ELIMINADO: Quitamos el margen negativo que causaba la superposición excesiva */
        position: relative;
        z-index: 3;
        /* padding: 0 2rem; <-- OPCIONAL: Puedes quitar esto si quieres que ocupen más ancho */
    }
    .feature-card {
        padding: 2rem;
        border-radius: 20px;
        color: #333;
        display: flex;
        align-items: center;
        gap: 1.5rem;
        transition: transform 0.3s;
        box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        text-decoration: none; /* Por si son enlaces */
    }
    .feature-card:hover { transform: translateY(-10px); }
    .feature-card h3 { font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem; }
    .feature-card p { margin: 0; opacity: 0.8; }
    .feature-icon { font-size: 4rem; }

    /* Colores específicos para cada tarjeta */
    .card-comunidad { background-color: #D4F1F4; /* Azul claro */ }
    .card-tienda { background-color: #E2D4F4; /* Violeta claro */ }
    .card-directorio { background-color: #FFF5D4; /* Amarillo claro */ }

    /* --- 3. SECCIÓN DE ENLACES RÁPIDOS --- */
    .quick-links-section {
        background-color: #fff;
        padding: 4rem 2rem;
        margin: 4rem 0;
        border-radius: 20px;
        box-shadow: 0 5px 25px rgba(0,0,0,0.05);
    }
    .links-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 2rem;
    }
    .links-column h4 {
        font-size: 1.3rem;
        font-weight: 700;
        margin-bottom: 1.5rem;
        color: #E88989; /* Rosa */
    }
    .links-column ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    .links-column li {
        margin-bottom: 0.8rem;
    }
    .links-column a {
        color: #555;
        text-decoration: none;
        font-weight: 500;
        transition: color 0.2s;
        display: flex; align-items: center; gap: 8px;
    }
    .links-column a:hover { color: #97a992; /* Verde al pasar el mouse */ }

    /* --- 4. CARRUSEL DE NOTICIAS (SWIPER) --- */
    .news-section-container {
        padding: 4rem 0;
        text-align: center;
    }
    .swiper {
        width: 100%;
        padding: 50px 0; /* Espacio para que las tarjetas sobresalgan */
    }
    .swiper-slide {
        background-position: center;
        background-size: cover;
        width: 320px;
        height: 420px;
        background: #fff;
        border-radius: 20px;
        box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        transition: transform 0.3s;
        overflow: hidden;
    }
    .swiper-slide-active {
        transform: scale(1.05); /* Resaltar la tarjeta central */
    }
    .news-card-img { height: 200px; width: 100%; object-fit: cover; }
    .news-card-body { padding: 1.5rem; text-align: left; display: flex; flex-direction: column; height: calc(100% - 200px); justify-content: space-between; }
    .news-title { font-weight: 700; font-size: 1.2rem; margin-bottom: 0.5rem; color: #333;
         display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
    .news-date { color: #999; font-size: 0.9rem; }
    .btn-read-more { 
        background-color: #E88989; color: white; padding: 10px 25px; border-radius: 50px; 
        text-decoration: none; font-weight: bold; align-self: flex-start; transition: background 0.3s; 
    }
    .btn-read-more:hover { background-color: #d17a7a; color: white; }

    /* --- 5. BANNER DE SUSCRIPCIÓN --- */
    .promo-banner {
        background: linear-gradient(90deg, #E88989 0%, #d17a7a 100%); /* Amarillo */
        padding: 4rem 2rem;
        text-align: center;
        border-radius: 20px;
        margin: 4rem auto;
        max-width: 1000px;
        color: #333;
        box-shadow: 0 10px 30px oklch(68.726% 0.14627 345.639 / 0.3);
    }
    .promo-title { font-size: 2.5rem; font-weight: 800; margin-bottom: 1rem; }

    /* Responsive */
    @@media (max-width: 768px) {
        .hero-title { font-size: 2.5rem; }
        .links-grid { grid-template-columns: 1fr; }
        .features-grid { grid-template-columns: 1fr; margin-top: 2rem; }
    }
</style>

<div class="hero-section" style="background-image: url('@bannerUrlConVersion');">
    <div class="hero-content">
        <h1 class="hero-title">El mundo que tu mascota merece</h1>
        <p class="hero-subtitle">Encuentra servicios, productos y los mejores consejos en un solo lugar.</p>
        <a asp-area="Identity" asp-page="/Account/Register" class="hero-btn">¡Únete Gratis!</a>
    </div>
</div>

<div class="section-container">

    <h2 class="features-title">¿Ya conoces lo que tenemos para ti?</h2>
    <div class="features-grid">
        <a asp-controller="Directorio" asp-action="Index" class="feature-card card-directorio">
            <span class="material-symbols-outlined feature-icon">map</span>
            <div>
                <h3>Directorio de Servicios</h3>
                <p>Encuentra veterinarias, guarderías y lugares pet-friendly cerca de ti.</p>
            </div>
        </a>
        <a asp-controller="PetShop" asp-action="Index" class="feature-card card-tienda">
            <span class="material-symbols-outlined feature-icon">storefront</span>
            <div>
                <h3>Tienda Online</h3>
                <p>Las mejores marcas y productos para consentir a tu peludo.</p>
            </div>
        </a>
        <a asp-controller="Noticias" asp-action="Index" class="feature-card card-comunidad">
            <span class="material-symbols-outlined feature-icon">forum</span>
            <div>
                <h3>Comunidad & Noticias</h3>
                <p>Consejos de expertos, historias felices y mucho más.</p>
            </div>
        </a>
    </div>

    <section class="quick-links-section">
        <h2 class="text-center mb-5" style="font-weight: 700; color: #333;">Somos todo lo que tu mascota necesita</h2>
        <div class="links-grid">
            <div class="links-column">
                <h4>Directorio Popular</h4>
                <ul>
                    <li><a asp-controller="Servicio" asp-action="Index" asp-route-busqueda="Miraflores">Veterinarias en Miraflores</a></li>
                    <li><a asp-controller="Guarderias" asp-action="Index">Hoteles para perros</a></li>
                    <li><a asp-controller="Lugares" asp-action="Index">Restaurantes Pet Friendly</a></li>
                    <li><a asp-controller="Adopcion" asp-action="Index">Adopción de mascotas</a></li>
                </ul>
            </div>
            <div class="links-column">
                <h4>Tienda Destacada</h4>
                <ul>
                    <li><a asp-controller="PetShop" asp-action="Productos" asp-route-tag="Perro" asp-route-tipo="Comida">Alimento para Perros</a></li>
                    <li><a asp-controller="PetShop" asp-action="Productos" asp-route-tag="Gato" asp-route-tipo="Accesorios">Rascadores para Gatos</a></li>
                    <li><a asp-controller="PetShop" asp-action="Productos" asp-route-tipo="Higiene">Salud e Higiene</a></li>
                    <li><a asp-controller="PetShop" asp-action="Productos" asp-route-tipo="Juguetes">Juguetes Interactivos</a></li>
                </ul>
            </div>
            <div class="links-column">
                <h4>Lo más buscado</h4>
                <ul>
                    <li><a href="#">Veterinaria 24 horas</a></li>
                    <li><a href="#">Entrenadores caninos</a></li>
                    <li><a href="#">Playas para perros</a></li>
                    <li><a href="#">Seguros para mascotas</a></li>
                </ul>
            </div>
        </div>
    </section>

    <section class="news-section-container">
        <h2 class="features-title">Noticias y Consejos Recientes</h2>
        
        <div class="swiper mySwiper">
            <div class="swiper-wrapper">
                @foreach (var noticia in Model)
                {
                    <div class="swiper-slide">
                        <img src="@noticia.UrlImagen" alt="@noticia.Titulo" class="news-card-img" onerror="this.src='/images/placeholder.png';" />
                        <div class="news-card-body">
                            <div>
                                <p class="news-date">@noticia.FechaPublicacion.ToString("dd MMM yyyy")</p>
                                <h3 class="news-title">@noticia.Titulo</h3>
                            </div>
                            <a asp-controller="Noticias" asp-action="Detalle" asp-route-id="@noticia.Id" class="btn-read-more">Leer nota</a>
                        </div>
                    </div>
                }
            </div>
            <div class="swiper-pagination"></div>
        </div>
    </section>

    <div class="promo-banner">
        <h2 class="promo-title">¡Únete a nuestra comunidad!</h2>
        
        <a asp-area="Identity" asp-page="/Account/Register" class="hero-btn" style="background-color: #333; color: #E88989;">Crear Cuenta Gratis</a>
    </div>

</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <script>
        var swiper = new Swiper(".mySwiper", {
            effect: "coverflow",
            grabCursor: true,
            centeredSlides: true,
            slidesPerView: "auto",
            coverflowEffect: {
                rotate: 0,
                stretch: 0,
                depth: 100,
                modifier: 2,
                slideShadows: false, // Quita sombras feas si las hay
            },
            loop: true,
             autoplay: {
                delay: 3000,
                disableOnInteraction: false,
            },
            pagination: {
                el: ".swiper-pagination",
                clickable: true,
            },
        });
    </script>
}