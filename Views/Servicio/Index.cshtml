@using X.PagedList.Mvc.Core;
@using X.PagedList;
@model IPagedList<PetConnect.Models.Servicio>
@{
    ViewData["Title"] = "Veterinarias";
}

<div class="directorio-page-v2">
    <div class="hero-banner">
        <img src="~/images/servicios/banner-veterinaria.jpg" alt="Perro en una toalla" />
        <div class="hero-text"><h1>Veterinarias</h1></div>
    </div>

    <div class="content-wrapper">
        <h2 class="page-subtitle">Encuentra la mejor veterinaria para tu mascota</h2>

        <form asp-controller="Servicio" asp-action="Index" method="get">
            @* Llamamos a la vista parcial del buscador *@
            @await Html.PartialAsync("_SearchBarPartial", ViewData["BusquedaActual"] as string)
        </form>

        <div class="listing-grid-v2">
            @foreach (var servicio in Model)
            {
                <a asp-action="Detalle" asp-route-id="@servicio.Id" class="listing-card-v2">
                    <div class="card-image">
                        <img src="@(servicio.ImagenPrincipalUrl ?? "/images/placeholder.png")" alt="Logo de @servicio.Nombre" />
                    </div>
                    <div class="card-content">
                        <div class="card-header">
                            <span class="card-category">@servicio.FundacionNombre</span>
                            <button class="card-favorite-btn"><span class="material-symbols-outlined">star</span></button>
                        </div>
                        <h3 class="card-title">@servicio.Nombre</h3>
                        <p class="card-location">
                            <span class="material-symbols-outlined">location_on</span>
                            Lince @* Esto debería venir de la BD, pero lo hardcodeamos por ahora *@
                        </p>
                    </div>
                    <div class="card-footer">
                        <span class="btn-ver-mas">Ver más <span class="material-symbols-outlined">arrow_forward</span></span>
                    </div>
                </a>
            }
        </div>

        <!-- Controles de Paginación -->
        <div class="pagination-container">
            @Html.PagedListPager(Model, page => Url.Action("Index", new { page, busqueda = ViewData["BusquedaActual"] }),
                new PagedListRenderOptions
                {
                    LiElementClasses = new string[] { "page-item" },
                    PageClasses = new string[] { "page-link" },
                    DisplayLinkToFirstPage = PagedListDisplayMode.Always,
                    DisplayLinkToLastPage = PagedListDisplayMode.Always,
                    DisplayLinkToNextPage = PagedListDisplayMode.Always,
                    DisplayLinkToPreviousPage = PagedListDisplayMode.Always
                })
        </div>
    </div>
</div>